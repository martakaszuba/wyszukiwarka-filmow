<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="style.css">
	<title>Wyszukiwarka filmów na filmwebie - Marta Kaszuba</title>
</head>
<body>
<div id="header">
	<h2>Wyszukiwarka filmów na filmwebie z rankingu top 500</h2>
</div>

<div id="search">
	<h3>Wyszukaj film: <input type="text" class="css-input" id="txt"></h3>
</div>

<div id="results">
</div>

<script>

var txt = document.querySelector("#txt");
var res = document.querySelector("#results");
var newArr;
txt.addEventListener("keyup", function(){
var xhr = new XMLHttpRequest();
xhr.open("GET", "dane.json", true);
xhr.onload = function(){
    if (this.status === 200){
        res.innerHTML ="";
        var data = JSON.parse(this.responseText);
            newArr = data.filter(function(val){
                return val.name.toLowerCase().includes(txt.value.toLowerCase()) && txt.value !=="" && txt.value.length>1;
            })
        }
        newArr.forEach(function(val){
        res.innerHTML +=`<div class="item">
        <div class="one-third">
        <img src =${val.image} class="img" alt="brak obrazka"/>
        </div>
        <div class="two-third">
        <a href=${val.link} target="_blank">
        <h2 class="name">${val.name}</h2>
        </a>
        <p class="rate">Ocena: ${val.rate}</p>
        <p class="count">Liczba głosów: ${val.count}</p>
        </div>
        </div>`
    })
    var img = document.querySelectorAll("img");
    img.forEach(function(val){
        if(val.src.includes("class")){
            val.remove();
        }
    })

    }
xhr.send();
})
</script>
</body>

</html>